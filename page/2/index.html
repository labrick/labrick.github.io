<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, Brick" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="工作实验室">
<meta property="og:url" content="http://labrick.github.io/page/2/index.html">
<meta property="og:site_name" content="工作实验室">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="工作实验室">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://labrick.github.io/page/2/"/>





  <title>工作实验室</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65978647-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?88010fa72f93e593c7b92e8a4eb25e3b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">工作实验室</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">专注于自我心智成长</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-books">
          <a href="/books" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            书籍
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'MDA2Yz6kTCszT2GimT9N','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2016/10/29/element-of-fitness/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/29/element-of-fitness/" itemprop="url">
                  入门训练计划表
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-29T13:50:05+08:00">
                2016-10-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/硬派健身/" itemprop="url" rel="index">
                    <span itemprop="name">硬派健身</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/29/element-of-fitness/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/29/element-of-fitness/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>训练次数：每周可以安排几次该项目训练，比如希望减脂塑形，又想丰胸的女性，可以安排 2 次丰胸翘臀训练，3 次减脂塑形训练。<br>抗阻力训练时间/HIIT 时间：无氧力量训练与 HIIT 高强度无氧间歇训练安排的配比。比如男性增肌塑形日可以安排 40 分钟力量训练，20 分钟 HIIT。</p>
<p>重量/次数 RM：除了减脂塑形的部位，其他部位训练一定要力竭！RM 即代表训练重量，又代表训练次数。RM（最大重复次数）的意思就是，该项目，用该重量做多少次力竭。</p>
<p>比如你举 100 千克哑铃，只能举一次，那么这就叫 1RM，次数是 1，重量是 100 千克（你的 100%最大负重）。</p>
<p>比如你举 80 千克哑铃，能举 8 次，那么这就叫 8RM，次数是 8，重量是 80 千克（你的 80%最大负重）。</p>
<p>所以 10RM 就是你选取一个你只能举 10 次的重量，做 10 次。</p>
<p>组间休息时间：每组间休息的时间，单位是秒。</p>
<p>动作套数：我们推荐一个动作做三组，套数就是选取多少个动作（3 组动作为一套）。</p>
<p>比如女性翘臀，你可以选择板凳深蹲，臀桥，单腿硬拉作为三套。</p>
<p>训练后是否拉伸：由于拉伸会增加你受伤的几率、降低你的最大力量，我们建议你训练前不要拉伸。拉伸会增加肌肉维度的生长，所以有的部位不适合安排训练后拉伸。（比如腿部训练，可安排在别的时候，例如吃饭后、看电视时候）</p>
<p>训练后热量摄入水平：由于训练后营养摄入可以增加第二天的能量（糖原储备），以及增加肌肉生长的潜力，所以一般训练后都要多吃些。低摄入是只吃日常的饭菜。中高摄入是可以摄入糖（如运动饮料），蛋白质（脱脂奶、蛋清等）。</p>
<p>训练后是否安排休息：肌肉生长需要时间，如果负荷和训练量较大，身体又需要恢复，要安排训后一天休息（至少休息该部位）。</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center">每周训练次数</th>
<th style="text-align:left">抗阻力训练/HIIT 时间(分钟)</th>
<th style="text-align:left">重量/次数</th>
<th style="text-align:left">组间休息(秒)</th>
<th style="text-align:left">动作套数</th>
<th style="text-align:left">是否拉伸</th>
<th style="text-align:left">训练后热量摄入</th>
<th style="text-align:left">训练日后是否休息</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">女性丰胸翘臀日</td>
<td style="text-align:center">2-3</td>
<td style="text-align:left">30/20</td>
<td style="text-align:left">8-12RM</td>
<td style="text-align:left">30-90</td>
<td style="text-align:left">3-5</td>
<td style="text-align:left">是</td>
<td style="text-align:left">中高</td>
<td style="text-align:left">可安排</td>
</tr>
<tr>
<td style="text-align:left">男女减脂塑形日</td>
<td style="text-align:center">2-3</td>
<td style="text-align:left">20/30</td>
<td style="text-align:left">20-30RM</td>
<td style="text-align:left">15-30</td>
<td style="text-align:left">4-6</td>
<td style="text-align:left">否</td>
<td style="text-align:left">低</td>
<td style="text-align:left">可安排</td>
</tr>
<tr>
<td style="text-align:left">男性增肌塑形日</td>
<td style="text-align:center">2-6</td>
<td style="text-align:left">40/20</td>
<td style="text-align:left">8-12RM</td>
<td style="text-align:left">30-90</td>
<td style="text-align:left">4-6</td>
<td style="text-align:left">是</td>
<td style="text-align:left">中高</td>
<td style="text-align:left">可安排</td>
</tr>
<tr>
<td style="text-align:left">男性瘦体型强增肌日</td>
<td style="text-align:center">2-5</td>
<td style="text-align:left">40/不安排</td>
<td style="text-align:left">6-10RM</td>
<td style="text-align:left">30-90</td>
<td style="text-align:left">4-6</td>
<td style="text-align:left">是</td>
<td style="text-align:left">高!</td>
<td style="text-align:left">可安排</td>
</tr>
</tbody>
</table>
<p>powered by 斌卡</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2016/07/28/sync-android-source/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/28/sync-android-source/" itemprop="url">
                  同步android源码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-28T14:47:50+08:00">
                2016-07-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工作记录/" itemprop="url" rel="index">
                    <span itemprop="name">工作记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/28/sync-android-source/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/28/sync-android-source/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>国内开发Android真是个坑货，本来做Android apk就很坑了，一个gradle不翻墙，你就等去吧，现在又轮到同步Android源码问题，一堆connect failed。</p>
<h2 id="解决方法">解决方法</h2><p>GFW的问题，当然首先想到的就是翻墙啊，不知道什么缘故，我们的ubuntu竟然启动不了shadesocks，这不是坑吗？其他还怎么给ubuntu翻墙啊，真不会啊，最近脑袋疼，也懒得查了。</p>
<p>大师兄说：我贡献给你个文档，换个国内的镜像网站就好。拿回来文档，他们跑gem5，同步的是Android官方的源码，改两个地方搞定：</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2016/06/29/overview-of-first-year-of-graduation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/29/overview-of-first-year-of-graduation/" itemprop="url">
                  我的研究生之路
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-29T23:40:12+08:00">
                2016-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/让生活更上一层楼/" itemprop="url" rel="index">
                    <span itemprop="name">让生活更上一层楼</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/06/29/overview-of-first-year-of-graduation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/29/overview-of-first-year-of-graduation/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一">一</h2><p>时光匆匆，研究生的一年时光已转瞬即逝，回首过往的一个学年，我觉得过得比较的充实而有意义，在这一年里有很多的收获，结识一群要好的朋友，学到很多新的知识，获得更强健的身体素质，思想上也有显著的提高，通过素质课也增长了不少的见识等等。这里我对这过往的一年进行一次总结，目的是总结经验，发现不足之处，以便于今后继续发扬优点，弥补不足。</p>
<h2 id="二">二</h2><p>首先值得一提的是项目经历，通过对项目从头到尾各个方面的广泛参与，了解了整个项目从申请到研发，再到终止的全过程，对其中的每个细节都有详细的记录，熟悉了Android底层驱动到JNI封装，再到Android应用开发的一整套的流程，之前一个Android小白，现在起码面对很多问题不会过于困惑而无从下手，对于很多基本问题都有一个自己的看法。</p>
<p>研一一年的基本课程也让我收益匪浅，特别值得一提的是系统芯片设计课程，从中学习了系统芯片设计的基本流程，之前一直困惑的软件控制硬件的问题现在也非常明晰了，而且还具体实践了下软件控制硬件的方法，很值得欣慰。当然还有很多其他优秀的课程也学习到了很多的知识，比如：数值分析让我明白了离散数据的分析方法，英语课程做让我在论文写作和英语写作技能上有了长足的进步等等。</p>
<p>我是一个比较重视增长见识的人，这一年中通过素质公开课程以及自己外出的所见所闻也见识了不少新奇的东西，比如：科学素质公开课中给我们讲的有关不同个体之间通过神经控制的课程让我们深有感触，让我们在这平庸的世界里又了解到一处新奇之处。</p>
<p>在这一年里我也一直保持着读书的习惯，不管是小说还是专业书籍，我坚持下了大概每两周一本书的习惯，并写下简单的评论作为总结，遇到经典或者感触比较深的书籍会写下自己的感想，知乎陈章鱼说：人丑就要读书，然后我得到：用心经营世界，人丑更要读书，这句话已经成为了我微信和QQ的签名。</p>
<h2 id="三">三</h2><p>另外我在思想上也有所提高，借助我之前的几段感慨如下：</p>
<p>一直听说读研学到多少东西是次要的，主要的是思想，虽然一直听说，但还不理解，也没有真正意识到思想的重要性！大学我一直注重的是技术，多学点技术多一门出路，但是这个是基础的，因为不论你学了多少技术你都是在给别人打工，别人说什么你就做什么，也很难领导别人，而且我还一直认为领导们应该是该技术领域的高手，现在看来都是错的，是观念错误，不是现实错误！</p>
<p>学习不同目的的实现方法：方法是具体的实现途径，给我们一个目的，我们要能够找到可以实现甚至很好的实现目的的方法，对于这个，因为我们所要达到的目的很多，所以我们不可能把所有的方法都实践一遍，那样时间也不够，所以我们需要的也和见识一样，需要大量的间接学习，很多问题我们只需要知道方法可以实现就可以，不需要追究我们必须亲自实现，这样就可以节约大量的时间，而这些时间是用来多了解不同目的的方法。</p>
<p>在行业领域上学习，看清楚前面的路：见识是大的方向，在一个无数种选择的世界里，我们总是找不到前面的路，如何选择路(领域)就是一种见识，如果我们见识广我们就能够相比较其他人更容易的找到前面的路，然后坚持下去基本就可以达到目的，而如果我们由于见识不足选择一条错误的道路，无论你怎么努力，你的结果都不会太好，甚至可能你走反了方向。</p>
<h2 id="四">四</h2><p>去年入学时我也写下了研究生应该做的事情：学好英语、增长见识、提升专业技能、自给自足满足温饱，回头看下后三项做的还不错，第一项做的就比较差劲了，买了不少的英语书籍，但也只是开始的一时兴起，并没有特别的进步，需要在英语方面多下点功夫。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2016/06/03/manage-user-and-group/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/03/manage-user-and-group/" itemprop="url">
                  Linux用户与组管理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-03T23:28:51+08:00">
                2016-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工作记录/" itemprop="url" rel="index">
                    <span itemprop="name">工作记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/06/03/manage-user-and-group/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/03/manage-user-and-group/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>创建组</p>
<pre><code><span class="variable">$sudo</span> addgroup <span class="keyword">group</span>Name
</code></pre><p>创建用户userName并加入组groupName</p>
<pre><code><span class="variable">$sudo</span> useradd <span class="keyword">user</span>Name -g <span class="keyword">group</span>Name -M                     <span class="comment"># 并指定唯一组groupName，并强制创建HOME目录（默认位置）</span>
<span class="variable">$sudo</span> useradd <span class="keyword">user</span>Name -g <span class="keyword">group</span>Name -M -d absolutePath     <span class="comment"># +指定HOME所在位置absolutePath</span>
</code></pre><p>增加已存在用户到指定组</p>
<pre><code><span class="variable">$sudo</span> adduser <span class="keyword">user</span>Name <span class="keyword">group</span>Name
</code></pre><p>从组中删除某用户</p>
<pre><code><span class="variable">$sudo</span> gpasswd -d <span class="keyword">user</span>Name <span class="keyword">group</span>Name
</code></pre><p>组用户成员维护</p>
<pre><code><span class="variable">$gpasswd</span> –a <span class="keyword">user</span>Name <span class="keyword">group</span>Name          <span class="comment"># 添加用户到组</span>
<span class="variable">$gpasswd</span> –d <span class="keyword">user</span>Name <span class="keyword">group</span>Name          <span class="comment"># 从组中删除</span>
<span class="variable">$gpasswd</span> –A 组管理员用户列表 <span class="keyword">group</span>Name      <span class="comment"># don't know</span>
</code></pre><p>显示用户ID及组信息：</p>
<pre><code><span class="variable">$id</span>
uid=<span class="number">1001</span>(dbh) gid=<span class="number">1001</span>(dbh) groups=<span class="number">115</span>(admin),<span class="number">1001</span>(dbh)
<span class="variable">$cat</span> /etc/<span class="keyword">group</span>
<span class="keyword">group</span>Name:x:<span class="number">1002</span>:<span class="keyword">user</span>Name
</code></pre><p>口令维护</p>
<pre><code><span class="variable">$passwd</span> <span class="keyword">user</span>Name
</code></pre><p>显示指定用户所属的组</p>
<pre><code><span class="variable">$groups</span> <span class="keyword">user</span>Name
</code></pre><p>文件属性相关</p>
<p>改变当前文件所属用户</p>
<pre><code><span class="variable">$chown</span> <span class="keyword">user</span>Name -R path
</code></pre><p>改变当前文件所属用户组</p>
<pre><code><span class="variable">$chgrp</span> <span class="keyword">group</span>Name -R path
</code></pre><p>改变当前目录下所有文件权限</p>
<pre><code><span class="label">$find</span> -<span class="keyword">type</span> f | xargs chmod xxx
<span class="label">$chmod</span> xxx `find -<span class="keyword">type</span> f`           <span class="comment">// 这种方法好像问题</span>
</code></pre><p>改变当前目录下所有文件夹权限</p>
<pre><code><span class="label">$find</span> -<span class="keyword">type</span> <span class="keyword">d</span> | xargs chmod xxx
<span class="label">$chmod</span> xxx `find -<span class="keyword">type</span> <span class="keyword">d</span>`           <span class="comment">// 这种方法好像有问题</span>
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2016/04/25/use-android-ndk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/use-android-ndk/" itemprop="url">
                  Android运行C程序
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-25T21:56:34+08:00">
                2016-04-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/04/25/use-android-ndk/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/25/use-android-ndk/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="编译Native_C的helloworld模块">编译Native C的helloworld模块</h4><ol>
<li>在Android源码下的development目录下创建一个名为hello的目录</li>
<li>在此目录下创建一个名为hello.c的C语言文件，代码如下：</li>
</ol>
<pre><code><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>
</span>{
    <span class="built_in">printf</span>(<span class="string">"Hello World!\n"</span>);
    <span class="keyword">return</span> <span class="number">0</span>;
}
</code></pre><ol>
<li>当前目录下创建Android.mk文件（Android Makefile标准命名，不可更改，内容可以参考其他已有的Android.mk文件的写法），内容如下：</li>
</ol>
<pre><code>LO<span class="built_in">CAL_PATH</span>:=$(call my-dir)
include $(CLEAR_VARS)
LO<span class="built_in">CAL_SRC_FILES</span>:=\
hello<span class="variable">.c</span>
LO<span class="built_in">CAL_MODULE</span> := helloworld
include $(B<span class="built_in">UILD_EXECUTABLE</span>)


<span class="number">1.</span> LO<span class="built_in">CAL_SRC_FILES</span>：用于指定源文件
<span class="number">2.</span> LO<span class="built_in">CAL_MODULE</span>：用于指定要编译模块的名字，在下一步编译时会用到。
<span class="number">3.</span> <span class="preprocessor">#include $(BUILD_EXECUTABLE)：表示要编译成一个可执行文件，如果想编译成动态库，则可用BUILD_SHARED_LIBRARY，这些具体用法可以在Android/build/core/config.mk查到。</span>
</code></pre><ol>
<li><p>返回Android源码顶层目录进行编译：</p>
<p> make helloworld</p>
<p> 需要注意的是make helloworld中的目标名helloworld就是Android.mk文件中由LOCAL_MODULE指定的模块名。</p>
</li>
<li><p>编译结果在Android/out/target/generic/system/bin/helloworld目录下</p>
</li>
</ol>
<p>这样通过adb push将它传送到Android开发板上，再通过adb shell登录到开发板即可执行</p>
<p>注意这里可能会存在Android文件系统没有权限问题，解决方法如下：</p>
<pre><code><span class="title">adb</span> remount
</code></pre><h4 id="手工编译C模块">手工编译C模块</h4><ol>
<li>在Android编译环境中，提供了showcommands选项来显示编译命令行，可以通过打开这个选项来查看一些编译时的细节。</li>
<li><p>在具体操作之前，需要使用如下命令把前面中的helloworld模块清除。</p>
<p> make clean-helloworld</p>
<p> 上面的make clean-$(LOCAL_MODULE)命令是Android编译环境提供的make clean的方式</p>
</li>
<li><p>使用showcommands选项重新编译helloworld，具体命令如下：</p>
<p> make helloworld showcommands</p>
</li>
</ol>
<p>生成helloworld可执行文件后，同上了</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2015/12/06/look-at-the-nature-of-phenomenon/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/06/look-at-the-nature-of-phenomenon/" itemprop="url">
                  洞察隐藏世界
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-12-06T10:01:30+08:00">
                2015-12-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/让生活更上一层楼/" itemprop="url" rel="index">
                    <span itemprop="name">让生活更上一层楼</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/12/06/look-at-the-nature-of-phenomenon/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/06/look-at-the-nature-of-phenomenon/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《苏菲的世界》">《苏菲的世界》</h2><p>最近一直在看<a href="http://book.douban.com/subject/2284311/" target="_blank" rel="external">《苏菲的世界》</a>，这是一本很好的床头书，其以书信或者篇幅短小的章节来完成整本书，很适合晚上休息或者早上不想起床时拿起看；</p>
<p>开头都是艾伯特通过书信方式启蒙苏菲的过程，书信的内容非常有价值（这个可以从世界观的重要性说起，不过这里不说这个），特别是讲述柏拉图对整个世界的认识部分，其在日常生活中找到了一个隐藏的真实世界；</p>
<p>这里引用书中柏拉图的结论：</p>
<blockquote>
<p>在“物质世界的背后，必定有一个实在存在。他(柏拉图)称这个实在为‘理型的世界’，其中包含存在于自然界各种现象背后、永恒不变的模式。”这种独树一格的观点我们称之为“柏拉图的理型论”</p>
</blockquote>
<p>因此他创建了柏拉图学园：</p>
<blockquote>
<p>柏拉图学园中教授的科目包括哲学、数学与体育。</p>
</blockquote>
<h2 id="采铜东篱下">采铜东篱下</h2><p>上面所讲的思想看似在哪里看到过，然后就查找到到知乎周刊第003期<a href="http://read.douban.com/ebook/1616920/" target="_blank" rel="external">《走，去拿10亿美金》</a>中有关终生受用技能问题，翻看一下对应的<a href="http://www.zhihu.com/question/20846401" target="_blank" rel="external">知乎问题链接</a>，大部分回答都仅仅停留在技能篇，也就是表面上可以即学即用的技能，但是<a href="http://www.zhihu.com/question/20846401/answer/16479420" target="_blank" rel="external">采铜</a>的回答却与众不同：从三观进行谈起，说明<strong>在我所见所感所知的世界之外，还有一个（或者多个）“隐藏的世界”</strong>，采铜说：他对隐藏世界存在深信不疑，列举隐藏世界存在的证据，洞察隐藏世界技能的优势…最终说自己在慢慢培养出<strong>对显性世界的将信将疑和对隐藏世界的充满敬畏</strong>。</p>
<h2 id="思考">思考</h2><p>柏拉图时代尚没有科学的影子，人们只能通过自己的感官来感知这个世界，仅有的猜测也是不完美的，在现在看来甚至是非常可笑的，但是没有这些人的思考也就没有理性世界的存在，也就不会产生现在的科学（全球知识理论体系），是他们发现在我们所感知的世界之外还有另外一个世界：客观实在的理性世界，柏拉图把理性世界比作模子，我们的感官世界是通过模子制作出的物品，模子是完美的，但是制作的物品则总是有瑕疵的，这个说法很直接，完全能够解释感官世界与理性世界的关系，不管对错，他总能启发我们思考，也比较有意思。</p>
<p>柏拉图：感官世界 —&gt; 理性世界，这是一次质的飞跃；</p>
<p>当今理性世界已逐步得到完善，对于理性世界我们已经内化于心，所以上面柏拉图的理论更多的是启发思考，并没有直接的应用价值，而采铜提到的隐藏世界则为我们指明了一条新的道路。</p>
<p>客观的看：采铜提到的隐藏世界属于理性世界，他是对理性世界的一种量的积累，他是在提醒我们：在我们每天习以为常的信息背后包含着仅仅查阅资料无法获得的信息，他举例说：</p>
<blockquote>
<p>你在任何一个搜索引擎里搜索，在微博或者其他社交网络里寻找，都很难找到这样一个可信的信息：明天哪只股票会涨停。可是，这个世界上确实有少部分人知道明天哪只股票会涨停，比如亲自坐庄某只股票的操盘手，可在公开、可见的互联网世界里，用尽一切可能的办法，你都无法直接得知哪只股票会涨停。也就是说，这个东西确实存在，可是你看不见。你看不见的世界，就是隐藏的世界，而这个世界很大，大过你的想象。</p>
</blockquote>
<p>这个能力就是通过表面信息和逻辑推理来推测事物背后运转情况的能力，和侦探破案的能力很像。这是一个可以长期探索的道路，不过是任重而道远。</p>
<h2 id="其他">其他</h2><p>另外柏拉图还有对”爱”的解读，很有意思：</p>
<blockquote>
<p>柏拉图同时认为，灵魂栖居在躯体内之前，原本就已经存在(它和所有的饼干模子一起躺在橱柜的上层)。然而一旦灵魂在某一具躯体内醒来时，它便忘了所有的完美的理型。然后，一个奇妙的过程展开了。当人类发现自然界各种不同的形式时，某些模糊的回忆便开始扰动他的灵魂。他看到了一匹马，然而是一匹不完美的马。(一匹姜饼马！)灵魂一看到这匹马，便依稀想起它在理型世界中所见过的完美“马”，同时涌起一股回到它本来领域的渴望。柏拉图称这种渴望为eros，也就是“爱”的意思。此时，灵魂体验到“一种回归本源的欲望”。从此以后．，肉体与整个感官世界对它而言，都是不完美而且微不足道的。灵魂渴望乘着爱的翅膀回“家”，回到理型的世界。它渴望从“肉体的枷锁”中挣脱。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2015/10/12/buddy-system-algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/12/buddy-system-algorithm/" itemprop="url">
                  伙伴系统算法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-12T17:22:51+08:00">
                2015-10-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/颇有技术含量/" itemprop="url" rel="index">
                    <span itemprop="name">颇有技术含量</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/10/12/buddy-system-algorithm/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/10/12/buddy-system-algorithm/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景">背景</h2><p>最近因为工作的需要开始调研伙伴系统算法，刚开始听到这个名词时竟然是一头雾水，什么都不知道，甚至对它还有一种神秘感、逃离感，不过这终抵不过理智的分析，搜索查一下总可以搞明白的。</p>
<h2 id="由分页引起的问题">由分页引起的问题</h2><p>我们知道内存分配时是按照“页框”进行分配的，一个页框也就4K，考虑多次分配释放之后的情况：</p>
<pre><code><span class="number">1.</span> 第一次申请<span class="number">2</span><span class="keyword">N</span>个页呢？简单，连续分<span class="number">2</span><span class="keyword">N</span>个页；
<span class="number">2.</span> 第二次再申请<span class="number">2</span><span class="keyword">N</span>个页？简单，接着上次的<span class="number">2</span><span class="keyword">N</span>个页往后分；
<span class="number">3.</span> 第三次请释放掉第一次申请的<span class="number">2</span><span class="keyword">N</span>个页？简单，直接收回；
<span class="number">4.</span> 第四次申请<span class="keyword">N</span>个页？是从第一次释放的位置分配还是从第二次申请空间的后面分配呢？
</code></pre><p>仔细想想：经过无数次无规律的内存申请释放之后，内存中肯定存在大量的小块内存，无法满足大内存申请的需求，即使小块内存是连着的也需要有种机制来将它们合并。伙伴系统就是解决大块内存管理问题的一种机制；</p>
<h2 id="伙伴的定义">伙伴的定义</h2><p>这里给出伙伴的概念，满足以下三个条件的称为伙伴：</p>
<pre><code><span class="bullet">1. </span>两个块大小相同；
<span class="bullet">2. </span>两个块地址连续；
<span class="bullet">3. </span>两个块必须是同一个大块中分离出来的；
</code></pre><h2 id="伙伴系统管理策略">伙伴系统管理策略</h2><p>可以在<a href="https://en.wikipedia.org/wiki/Buddy_memory_allocation" target="_blank" rel="external">维基百科</a>上找到该算法的描述，大体如是：</p>
<h3 id="分配内存：">分配内存：</h3><ol>
<li>寻找大小合适的内存块（大于等于所需大小并且最接近2的幂，比如需要27，实际分配32）<ol>
<li>如果找到了，分配给应用程序。</li>
<li>如果没找到，分出合适的内存块。<ol>
<li>对半分离出高于所需大小的空闲内存块</li>
<li>如果分到最低限度，分配这个大小。</li>
<li>回溯到步骤1（寻找合适大小的块）</li>
<li>重复该步骤直到一个合适的块</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="释放内存：">释放内存：</h3><ol>
<li>释放该内存块<ol>
<li>寻找相邻的块，看其是否释放了。</li>
<li>如果相邻块也释放了，合并这两个块，重复上述步骤直到遇上未释放的相邻块，或者达到最高上限（即所有内存都释放了）。</li>
</ol>
</li>
</ol>
<p>上面这段文字可能看起来很费劲，我们看个内存分配和释放的示意图：</p>
<p><img src="http://7xkoxp.com1.z0.glb.clouddn.com/buddy-system-algorithm/buddy-memory-allocation.jpg" alt="内存分配和释放示意图"></p>
<p>上图中，首先我们假设我们一个内存块有1024K，当我们需要给A分配70K内存的时候，</p>
<ol>
<li>我们发现1024K的一半大于70K，然后我们就把1024K的内存分成两半，一半512K。</li>
<li>然后我们发现512K的一半仍然大于70K，于是我们再把512K的内存再分成两半，一半是128K。</li>
<li>此时，我们发现128K的一半小于70K，于是我们就分配为A分配128K的内存。</li>
</ol>
<p>后面的，B，C，D都这样，而释放内存时，则会把相邻的块一步一步地合并起来（合并也必需按分裂的逆操作进行合并）。</p>
<p>这样的算法，用二叉树这个数据结构比较合适。</p>
<p>分配器的整体思想是，通过一个数组形式的完全二叉树来监控管理内存，二叉树的节点用于标记相应内存块的使用状态，高层节点对应大的块，低层节点对应小的块，在分配和释放中我们就通过这些节点的标记属性来进行块的分离合并。如图所示，假设总大小为16单位的内存，我们就建立一个深度为5的满二叉树，根节点从数组下标[0]开始，监控大小16的块；它的左右孩子节点下标[1~2]，监控大小8的块；第三层节点下标[3~6]监控大小4的块……依此类推。</p>
<p><img src="http://7xkoxp.com1.z0.glb.clouddn.com/buddy-system-algorithm/binary-tree-of-buddy.jpg" alt="伙伴系统二叉树"></p>
<p>在分配阶段，首先要搜索大小适配的块，假设第一次分配3，转换成2的幂是4，我们先要对整个内存进行对半切割，从16切割到4需要两步，那么从下标[0]节点开始深度搜索到下标[3]的节点并将其标记为已分配。第二次再分配3那么就标记下标[4]的节点。第三次分配6，即大小为8，那么搜索下标[2]的节点，因为下标[1]所对应的块被下标[3~4]占用了。</p>
<p>在释放阶段，我们依次释放上述第一次和第二次分配的块，即先释放[3]再释放[4]，当释放下标[4]节点后，我们发现之前释放的[3]是相邻的，于是我们立马将这两个节点进行合并，这样一来下次分配大小8的时候，我们就可以搜索到下标[1]适配了。若进一步释放下标[2]，同[1]合并后整个内存就回归到初始状态。</p>
<p>一直到这，<a href="http://coolshell.cn/articles/10427.html" target="_blank" rel="external">这里</a>讲的都很好，但是接下来的内容，在原blog上就有所欠缺了，最起码我是没看懂他对程序的解释，下面我就将我对程序的解释贴在下面。</p>
<h2 id="伙伴系统程序分析">伙伴系统程序分析</h2><p><a href="https://github.com/cloudwu/buddy" target="_blank" rel="external">cloudwu</a>和<a href="https://github.com/wuwenbin/buddy2" target="_blank" rel="external">wuwenbin</a>写的两份开源实现和测试用例。实际上后一份是对前一份的精简和优化，而且这份实现真正体现了“极简”二字，追求突破常规的，极致简单的设计，<strong><a href="https://github.com/labrick/buddy2/blob/master/buddy2.c" target="_blank" rel="external">这里</a>是我对该程序的注解</strong>。</p>
<p>下面我将几个比较难以理解的点，也是传说中的精华部分在下面解释一下：</p>
<h3 id="伙伴分配器数据结构">伙伴分配器数据结构</h3><pre><code>truct buddy2{
    <span class="keyword">unsigned</span> size;            <span class="comment">// 管理内存的总单元数目，unsigned后省略的是int</span>
    <span class="keyword">unsigned</span> longest[<span class="number">1</span>];    <span class="comment">// 二叉树的节点标记，表明该节点可分配的最大单元数</span>
};
</code></pre><p>不论是从存储结构上还是从变量声明（数组成员数为1）上看，这个结构体都比较有意思，我们结合下面一段程序来看：</p>
<pre><code><span class="keyword">for</span> <span class="params">(i = <span class="number">0</span>; i &lt; <span class="number">2</span> * size - <span class="number">1</span>; ++i)</span>{
    <span class="keyword">if</span> <span class="params">(IS_POWER_OF_2<span class="params">(i+<span class="number">1</span>)</span>)</span>
        node_size /= <span class="number">2</span>;
    self-&gt;longest[i] = node_size;        <span class="comment">// 经验证，这里可以正确向后访问 </span>
}
</code></pre><p>它是不是发生了语法错误（i的值肯定会有大于0的时候），但是我在运行时竟然没有报错。然后我就做了个测试，程序在<a href="https://github.com/labrick/buddy2/blob/master/code_test.c" target="_blank" rel="external">这里</a>，为了解读方便，我再将程序片段拷贝一份：</p>
<pre><code>void main()
{
    <span class="keyword">struct</span> buddy2 <span class="keyword">self</span>;
      unsigned node_size;
      <span class="keyword">int</span> i,size=<span class="number">32</span>;

      <span class="keyword">self</span>-&gt;size = size;        <span class="comment">// 第一个结构体的size存放总的块数size</span>
      node_size = size * <span class="number">2</span>;        <span class="comment">// 总共的sizeof(unsigned)数</span>

    <span class="keyword">struct</span> buddy2* init = (<span class="keyword">struct</span> buddy2*)&amp;<span class="keyword">self</span>;

    init-&gt;size = <span class="number">32</span>
    init-&gt;longest[<span class="number">0</span>] = <span class="number">222</span>;
      <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++)
          printf(<span class="string">"self-&gt;size=%d\tself-&gt;longest[%d]=%d\r\n"</span>,<span class="keyword">self</span>-&gt;size,i,<span class="keyword">self</span>-&gt;longest[i]);
}
</code></pre><p>可以看到这样不符合C语言语法的程序当然会运行错误：segmentation fault，也就是产生了越界错误；</p>
<p>但是按照buddy2中的程序，我们再做一次实验：</p>
<pre><code><span class="keyword">void</span> main()
{
      <span class="keyword">struct</span> buddy2* <span class="keyword">self</span>;
      <span class="keyword">unsigned</span> node_size;
      <span class="keyword">int</span> i,size=<span class="number">32</span>;

      <span class="keyword">self</span> = (<span class="keyword">struct</span> buddy2*)ALLOC( <span class="number">2</span> * size * <span class="keyword">sizeof</span>(<span class="keyword">unsigned</span>));
      <span class="keyword">self</span>-&gt;size = size;        <span class="comment">// 第一个结构体的size存放总的块数size</span>
      node_size = size * <span class="number">2</span>;        <span class="comment">// 总共的sizeof(unsigned)数</span>

    <span class="comment">// 以下是验证longest访问正确性的</span>
    <span class="keyword">unsigned</span>* init = (<span class="keyword">unsigned</span>*)<span class="keyword">self</span>;
      <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">64</span>; i++,init++)
      {
          *init = i;
      }

      init = (<span class="keyword">unsigned</span>*)<span class="keyword">self</span>;
      printf(<span class="string">"memories allocated:\r\n"</span>);
      <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">64</span>; i++,init++)
          printf(<span class="string">"%d\t"</span>,*init);
      <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++)
          printf(<span class="string">"self-&gt;size=%d\tself-&gt;longest[%d]=%d\r\n"</span>,<span class="keyword">self</span>-&gt;size,i,<span class="keyword">self</span>-&gt;longest[i]);
}
</code></pre><p>这里我是将所分配的内存区域按照0 1 2 3 …的方式存放数据，然后按照self-&gt;size,self-&gt;longest[1],self-&gt;longest[1] …的方式进行读取打印，查看显示的内容的存储方式问题，结果很出乎意料：</p>
<pre><code><span class="number">1</span>. 首先是能正常运行，没有发生数组越界问题，这个和上面一个程序的区别在于内存分配的方式不同；
<span class="number">2</span>. <span class="keyword">self</span>-&gt;longest[<span class="number">0</span>...]竟然是按照内存的存储方式连续读取的数值，很不可思议，不过这是事实；
<span class="number">3</span>. 只在分配的内存区域起始位置定义个结构体，<span class="keyword">self</span>-&gt;size出现一次，后面都是<span class="keyword">self</span>-&gt;longest的值；
</code></pre><p>以上结论出乎我的意料，但是事实证明它就是事实，只能接受，不过<strong>尚缺少理论支持</strong>。</p>
<p>现在我们在回到原程序当中，并且我对他做了一些改变再看一下结果：</p>
<pre><code><span class="keyword">void</span> main()
{
      <span class="keyword">struct</span> buddy2* <span class="keyword">self</span>;
      <span class="keyword">unsigned</span> node_size;
      <span class="keyword">int</span> i,size=<span class="number">32</span>;

      <span class="keyword">self</span> = (<span class="keyword">struct</span> buddy2*)ALLOC( <span class="number">2</span> * size * <span class="keyword">sizeof</span>(<span class="keyword">unsigned</span>));
      <span class="keyword">self</span>-&gt;size = size;        <span class="comment">// 第一个结构体的size存放总的块数size</span>
      node_size = size * <span class="number">2</span>;        <span class="comment">// 总共的sizeof(unsigned)数</span>

      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span> * size - <span class="number">1</span>; ++i) {
        <span class="keyword">if</span> (IS_POWER_OF_2(i+<span class="number">1</span>))
          node_size /= <span class="number">2</span>;
        <span class="keyword">self</span>-&gt;longest[i] = node_size;        <span class="comment">// 经验证，这里可以正确向后访问 </span>
      }

      printf(<span class="string">"memories allocated:\r\n"</span>);
    <span class="keyword">unsigned</span>* init = (<span class="keyword">unsigned</span>*)<span class="keyword">self</span>;
      <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt; <span class="number">2</span> * size; i++,init++)
      {
          printf(<span class="string">"%d\n"</span>,*init);
      }
}
</code></pre><p>我们打印出的结果是：两个32，2个16，4个8，8个4，16个2，32个1</p>
<p>第一个32是self-&gt;size，第二个是根节点0，后面依次为节点1,2,3…</p>
<p>这样的存储确实很牛逼，占用空间少，操作简单，不过难以理解；</p>
<h3 id="调整参数为2的幂次方">调整参数为2的幂次方</h3><pre><code><span class="keyword">static</span> unsigned fixsize(unsigned <span class="keyword">size</span>){
    <span class="keyword">size</span> |= <span class="keyword">size</span> &gt;&gt; <span class="number">1</span>;
    <span class="keyword">size</span> |= <span class="keyword">size</span> &gt;&gt; <span class="number">2</span>;
    <span class="keyword">size</span> |= <span class="keyword">size</span> &gt;&gt; <span class="number">4</span>;
    <span class="keyword">size</span> |= <span class="keyword">size</span> &gt;&gt; <span class="number">8</span>;
    <span class="keyword">size</span> |= <span class="keyword">size</span> &gt;&gt; <span class="number">16</span>;
    <span class="keyword">return</span> <span class="keyword">size</span>+<span class="number">1</span>;
}
</code></pre><p>找到个注释是这样的：</p>
<pre><code>/*
 * 把<span class="built_in">size</span>调整到向上取到最近的<span class="number">2</span>次幂
 * <span class="built_in">size</span> |= <span class="built_in">size</span> &gt;&gt; n;表示从低位到高位按n位分组,每组内高n位复制到低n位
 * 最后经过处理<span class="built_in">size</span>是从最高位的<span class="number">1</span>开始往低位全<span class="number">1</span>的整数
 * <span class="keyword">return</span> <span class="built_in">size</span> + <span class="number">1</span>; 得到向上凑够最近<span class="number">2</span>次幂
 */
</code></pre><p>说实话，我没看懂。</p>
<h3 id="结束">结束</h3><p>搞懂上面的两个问题，尤其是第一个问题，后面的阅读都很顺利了。</p>
<h2 id="伙伴系统优缺点">伙伴系统优缺点</h2><p>伙伴分配的实质就是一种特殊的“分离适配”，即将内存按2的幂进行划分，相当于分离出若干个块大小一致的空闲链表，搜索该链表并给出同需求最佳匹配的大小。</p>
<p>其优点是快速搜索合并（O(logN)时间复杂度）以及低外部碎片（最佳适配best-fit）；</p>
<p>其缺点是内部碎片，因为按2的幂划分块，如果碰上66单位大小，那么必须划分128单位大小的块。但若需求本身就按2的幂分配，比如可以先分配若干个内存池，在其基础上进一步细分就很有吸引力了。 </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2015/10/05/echo-after-think-over/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/05/echo-after-think-over/" itemprop="url">
                  念念不忘 必有回响
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-05T12:45:48+08:00">
                2015-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/让生活更上一层楼/" itemprop="url" rel="index">
                    <span itemprop="name">让生活更上一层楼</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/10/05/echo-after-think-over/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/10/05/echo-after-think-over/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="那时候">那时候</h2><p>从开始学语文到现在，就没有写好过作文，怕考语文就是怕考作文，通篇瞎扯，无逻辑、无辞藻。下面是一个好友的随笔，我借来学习学习。:-) :-) :-)</p>
<h2 id="正文">正文</h2><p>阴雨连绵的夏末秋初，草木却依旧葱茏着，被雨水洗刷后愈加清新明亮。出了车站就已转向，分不清东南西北。这座小城转瞬之间，已不再是我初次到访时的模样。新的草木和建筑，从旧土壤里萌发生长，一如被战争摧毁的罗马在废墟上重建，此刻它焕然一新。</p>
<p>那时候，我大概……二十岁？记不清了。而在我离开后的这几年，我其实，过得也还好。我在鳞次栉比的水泥森林间行走，在夜晚会热闹起来的大街上，遇见很多的人。我看见他们张望、交谈、笑，看见他们各自生活的一角，看见一扇扇窗口里漏出的暖黄的灯火。跟二十岁相比，虽然过着不咸不淡的生活，但我知道自己仍在悄悄变化着。譬如一颗心，何尝还是二十岁的心？谁能保持赤子的情怀，只因没有看过这个世界，就毫无畏惧地沿着一条路跑下去，无怨无悔。那样倔强，倔强到根本不信有自己的意志打动不了的世界。</p>
<p>可是过了这几年，我开始想会不会因为那时不过是小孩儿？当现在我有能力对着乱七八糟的旅游纪念品买上一气、到处胡吃海塞走累了就打车、忘带了毛巾水杯到超市买自己喜欢的而不用考虑价格时，我会记起当年那场狼狈中断的旅行。站在同样的地方，仿佛看见二十岁时的自己从千年古渡口逆光走来，带着某种陌生的熟悉，似是昨日相识的新友。她问我是否后悔，而我无法回答，唯有默然。</p>
<p>你知道我在害怕么？我害怕忘了当初的自己，因为一旦忘了，我就要失去那部分我自己了——懵懂却执着，傻到浑身都是勇气。</p>
<p>最是人间留不住，朱颜辞镜花辞树。</p>
<p>踏着濡湿的青石阶慢慢地走，雾水漫漫，沾潮了衣衫。僧人们正在朝会。经幡随风涌动，木鱼点点地敲，朦胧氤氲的香火里，平缓而急促的诵经声伴着秋雨濛濛，竟有些令人安宁的静谧与庄重。有香客在堂前的莲花座上长跪拜谒，虔诚之下，想来也是隐藏着有求于佛的愿请。记得准备启程时，朋友让我去这名寺里求一支签，说如果签好就带回来，如果不好就扔掉。可我拒绝，因为不肯把自己的命运交给别人，哪怕是大慈大悲的佛祖也不行。我总想把选择权握在自己手里，只有这样，才不会后悔。因为人，总是舍不得怪罪自己，所以难得后悔。</p>
<p>《金刚经》里说：一切有为法，如梦幻泡影，如露亦如电，应作如是观。我对自己的执着，终是有所回应。那些落寞的行程，随着自己的重塑和叙述，变成了别人眼中的故事。而我不会较真，只将这个故事随随便便地放在这里，点上台灯，就着一壶热茶喝下，不再像个被执念困住的木偶，从此全然如新。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2015/09/12/assembly-in-c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/12/assembly-in-c/" itemprop="url">
                  C语言中嵌入汇编程序
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-12T11:39:07+08:00">
                2015-09-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux0-11相关/" itemprop="url" rel="index">
                    <span itemprop="name">linux0.11相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/12/assembly-in-c/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/12/assembly-in-c/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景">背景</h2><p>阅读linux0.11源码的<a href="https://github.com/labrick/linux-0.11/blob/v1.0/kernel/traps.c" target="_blank" rel="external">kernel/traps.c</a>文件里包含了几个语句是内嵌的汇编程序，虽知道整体的意思，但是细化后就不明所以然，这里记录下。</p>
<h2 id="C中嵌入汇编程序">C中嵌入汇编程序</h2><h3 id="格式">格式</h3><pre><code><span class="keyword">asm</span>(<span class="string">"汇编语句"</span>
    : 输出寄存器
    : 输入寄存器
    : 会被修改的寄存器
    );
</code></pre><p>带冒号的行可以省略，“输出寄存器”表示汇编执行完后，存放输出数据的寄存器，“输入寄存器”开始执行代码的时候，指定指定寄存器存放值。</p>
<h3 id="实例代码">实例代码</h3><h4 id="示例1">示例1</h4><pre><code><span class="keyword">int</span> a=<span class="number">10</span>,b;
asm(<span class="string">"movl <span class="variable">%1</span>, <span class="variable">%%</span>eax;
     movl <span class="variable">%%</span>eax, <span class="variable">%0</span>;"</span>
     :<span class="string">"=r"</span>(b)
     :<span class="string">"r"</span>(a)
     :<span class="string">"<span class="variable">%eax</span>"</span>
    );
</code></pre><p>表示C语言里的“b=a;”。<br>“r”表示使用任意寄存器，%0、%1表示使用两个寄存器，一般只能%0~%9共十个操作数，按输入输出寄存器出现顺序进行映射。<br>寄存器用两个百分号，是因为使用了%0%1这些数字使百分号有了特殊意义，所以在操作数出现的寄存器必须用双百分表示。<br>会被修改的寄存器里边的%eax表示eax寄存器在汇编代码块执行过程中会被改写，在执行前要保护好，这是提交给编译器决定的。</p>
<h4 id="示例2">示例2</h4><pre><code>#define get_seg_byte<span class="list">(<span class="keyword">seg</span>,addr)</span> <span class="list">({ \
    register char __res<span class="comment">; \</span>
    __asm__<span class="list">(<span class="string">"push %%fs; \                // 将fs寄存器值压栈
        mov %%ax,%%fs; \                // 将eax中的段值赋值给fs寄存器
        movb %%fs:%2,%%al; \            // 将fs:(*(addr)) --&gt; al
        pop %%fs"</span> \                        // 弹出fs
    :<span class="string">"=a"</span> <span class="list">(<span class="keyword">__res</span>)</span> \                        // 将eax值 --&gt; __res
    :<span class="string">"0"</span> <span class="list">(<span class="keyword">seg</span>)</span>,<span class="string">"m"</span> <span class="list">(<span class="keyword">*</span><span class="list">(<span class="keyword">addr</span>)</span>)</span>)</span><span class="comment">; \</span>
    __res<span class="comment">;})</span></span>
</code></pre><p>表示取段seg中地址addr处的一个字符。<br>上面是<a href="https://github.com/labrick/linux-0.11/blob/v1.0/kernel/traps.c" target="_blank" rel="external">kernel/traps.c</a>中的一段代码，其中：</p>
<p>参数：seg - 段选择符；addr - 段内指定地址。<br>输出：%0 - eax(__res)；输入：%1 - eax(seg)；%2 - 内存地址(*(addr))。<br>“=a”中的’a’称为加载代码，’=’表示这是输出寄存器，执行完后，eax的值将赋给_res,’”0” (seg)’表示在这段代码开始运行时将seg放到eax寄存器中，”0”(0可以省略)表示这里使用的寄存器和上面输出寄存器一样。</p>
<p>编译器规定：标号从输出寄存器的最左边开始，被编号为0，往右和往下将被依次编号。所以这里的”0”表示eax，”1”表示seg，”2”表示*(addr)。</p>
<p>%%fs:%2是使用编号为2的变量(*(addr))，这里加上%%fs的意思？？</p>
<h4 id="示例3">示例3</h4><p>// 取段seg中地址addr处的一个字长(4字节)。<br>// 参数：seg - 段选择符；addr - 段内指定地址。<br>// 输出：%0 - eax(__res)；输入：%1 - eax(seg)；%2 - 内存地址(*(addr))。</p>
<pre><code>#define get_seg_long<span class="list">(<span class="keyword">seg</span>,addr)</span> <span class="list">({ \
    register unsigned long __res<span class="comment">; \</span>
    __asm__<span class="list">(<span class="string">"push %%fs; \
            mov %%ax,%%fs; \
            movl %%fs:%2,%%eax; \
            pop %%fs"</span> \
    :<span class="string">"=a"</span> <span class="list">(<span class="keyword">__res</span>)</span> \
    :<span class="string">"0"</span> <span class="list">(<span class="keyword">seg</span>)</span>,<span class="string">"m"</span> <span class="list">(<span class="keyword">*</span><span class="list">(<span class="keyword">addr</span>)</span>)</span>)</span><span class="comment">; \</span>
    __res<span class="comment">;})</span></span>
</code></pre><h4 id="示例4">示例4</h4><p>// 取fs段寄存器的值(选择符)。<br>// 输出：%0 - eax(__res)</p>
<pre><code><span class="preprocessor">#define _fs() ({ \</span>
    <span class="keyword">register</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> __res; \
    __asm__(<span class="string">"mov %%fs,%%ax"</span> \
    :<span class="string">"=a"</span> (__res) \
    :                        <span class="comment">// 没有输入寄存器</span>
    ); \
    __res;})
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://labrick.github.io/2015/09/11/git-tags-usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brick">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="工作实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/11/git-tags-usage/" itemprop="url">
                  git-tag使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-11T21:28:54+08:00">
                2015-09-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具使用/" itemprop="url" rel="index">
                    <span itemprop="name">工具使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/11/git-tags-usage/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/11/git-tags-usage/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="tag背景">tag背景</h2><p>之前很少用git tag，感觉应该挺好用的，但是懒的去学习，但最近写一些学习代码，分为几个比较明显的版本，所以就差了下怎么用，其实用起来也挺简单的，只不过需要记住条指令，这里就记录一下。</p>
<h2 id="tag使用">tag使用</h2><p>我们可以创建一个tag来指向软件开发中的一个关键时期，比如版本号更新的时候可以建一个“v2.0”、“v3.1”之类的标签，这样在以后回顾的时候会比较方便。tag的使用很简单，主要操作有：查看tag、创建tag、验证tag以及共享tag。</p>
<h3 id="查看tag">查看tag</h3><p>列出所有tag：</p>
<pre><code>git <span class="built_in">tag</span>
</code></pre><p>这样列出的tag是按字母排序的，和创建时间没关系。如果只是想查看某些tag的话，可以加限定：</p>
<pre><code><span class="label">git</span> tag -l <span class="literal">v1</span>.*
</code></pre><p>这样就只会列出1.几的版本。</p>
<h3 id="创建tag">创建tag</h3><p>创建轻量级tag：</p>
<pre><code><span class="label">git</span> tag <span class="literal">v1</span>.<span class="number">0</span>
</code></pre><p>这样创建的tag没有附带其他信息，与之相应的是带信息的tag：</p>
<pre><code>git tag -<span class="tag">a</span> v1.<span class="number">0</span>-m <span class="string">'first version'</span>
</code></pre><p>-m后面带的就是注释信息，这样在日后查看的时候会很有用，这种是普通tag，还有一种有签名的tag：</p>
<pre><code>git tag -s v1.0-m '<span class="keyword">first</span> <span class="property">version</span>'
</code></pre><p>前提是你有GPG私钥，把上面的a换成s就行了。除了可以为当前的进度添加tag，我们还可以为以前的commit添加tag：</p>
<pre><code><span class="number">1.</span> <span class="comment">#首先查看以前的commit</span>
<span class="number">2.</span> git <span class="built_in">log</span> <span class="comment">--oneline</span>
<span class="number">3.</span> <span class="comment">#假如有这样一个commit：8a5cbc2 updated readme</span>
<span class="number">4.</span> <span class="comment">#这样为他添加tag</span>
<span class="number">5.</span> git tag -<span class="operator">a</span> v1.18a5cbc2
</code></pre><h3 id="删除tag">删除tag</h3><p>很简单，知道tag名称后：</p>
<pre><code>git tag -d v1.<span class="number">0</span>
git push origin <span class="symbol">:refs/tags/v1</span>.<span class="number">0</span>
</code></pre><h3 id="验证tag">验证tag</h3><p>如果你有GPG私钥的话就可以验证tag：</p>
<pre><code><span class="label">git</span> tag -v <span class="literal">v1</span>.<span class="number">0</span>
</code></pre><h3 id="共享tag">共享tag</h3><p>我们在执行git push的时候，tag是不会上传到服务器的，比如现在的github，创建tag后git push，在github网页上是看不到tag的，为了共享这些tag，你必须这样：</p>
<pre><code>git push origin <span class="comment">--tags</span>
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Brick" />
          <p class="site-author-name" itemprop="name">Brick</p>
           
              <p class="site-description motion-element" itemprop="description">随风的个人博客 </p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">47</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/labrick" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/lbrick" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/larrybrick" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://zhihu.com/people/larrybrick" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.wowotech.net/" target="_blank" title="蜂窝">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  蜂窝
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Brick</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"labrick"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  
















  





  

  

  

  

  

</body>
</html>
